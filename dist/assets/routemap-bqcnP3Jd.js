import{l as x,V as _,f as v,T as p,X as m,F as z,S as b,a as E,b as S,G as T,P as C,M as P,d as j,c as A,I as B,e as G,g as I}from"./index-BYzSYGK_.js";import{C as L,T as k}from"./toolbar-o_ukZz47.js";x.install("G-VGB0R7REN2");const F="./share/",o={lon:138.723345,lat:35.931243,zoom:13,map:0,url:F+"routemap.geojson"};for(const e of location.search.slice(1).split("&")){const t=e.split("=");t[0]==="url"?o[t[0]]=decodeURIComponent(t[1]):t[0]in o&&(o[t[0]]=Number(t[1]))}const d=new _({center:v([o.lon,o.lat]),maxZoom:18,minZoom:5,constrainResolution:!0,zoom:o.zoom}),g=['<a href="https://maps.gsi.go.jp/development/ichiran.html">地理院タイル</a>'],M=new p({source:new m({attributions:g,url:"https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png"}),title:"標準",type:"base",visible:o.map==0}),V=new p({source:new m({attributions:g,url:"https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png"}),title:"淡色",type:"base",visible:o.map==1}),Z=new p({source:new m({attributions:g,url:"https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg"}),title:"写真",type:"base",visible:o.map==2}),N=new p({source:new m({attributions:['&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors, ','&copy; <a href="https://opentopomap.org/">OpenTopoMap</a> ','(<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'],url:"https://tile.opentopomap.org/{z}/{x}/{y}.png"}),title:"OTM",type:"base",visible:o.map==3}),O=new z({color:"blue"}),R=new b({color:"white",width:2}),U="14px sans-serif";function X(e){var s;let t;const i=e.getGeometry().getType();if(i==="LineString"){const c=e.get("_color").match(/^#(..)(..)(..)$/).slice(1).map(l=>parseInt(l,16));c[3]=e.get("_opacity"),t={stroke:new b({color:c,width:e.get("_weight"),lineDash:(s=e.get("_dashArray"))==null?void 0:s.split(",")})}}else i==="Point"&&(t={image:new B({src:e.get("_iconUrl"),size:e.get("_iconSize"),anchor:e.get("_iconAnchor"),anchorXUnits:"pixels",anchorYUnits:"pixels"}),text:new G({text:e.get("name"),font:U,fill:O,stroke:R,textAlign:"left",offsetX:12,offsetY:3})});return new I(t)}const w=new E({source:new S({url:o.url,format:new T}),title:"GPSデータ",style:X}),f=new L({element:document.getElementById("centercross")}),n=new k({element:document.getElementById("toolbar")}),u=new C({autoPan:!1}),a=new P({target:"map",layers:[M,V,Z,N,w],view:d,controls:j().extend([new A,f,n]),overlays:[u]}),y={passive:!0},Y=document.getElementById("menu2");n.setToggleButton("tb_menu2",Y);n.setPopup(u);n.setCenterButton("tb_center");n.setBaseSelect("tb_base");n.setZoomSelect("tb_zoom",e=>d.setZoom(e));n.setLayerCheckbox("tb_track",w);n.setControlCheckbox("tb_cross",f);a.on("click",function(e){a.forEachFeatureAtPixel(e.pixel,function(t,i){const s=t.getGeometry();if(s.getType()!=="Point")return!1;let c="<h2>"+t.get("name")+"</h2>";const l=t.getKeys().filter(r=>r!=="geometry"&&r!=="name"&&r.charAt(0)!=="_");return l.length>0&&(c+="<table><tbody><tr><td>"+l.map(r=>r+"</td><td>"+t.get(r)).join("</td></tr><tr><td>")+"</td></tr></tbody></table>"),u.show(s.getCoordinates(),c),!0})},y);a.on("pointermove",function(e){if(e.dragging)return;const t=a.forEachFeatureAtPixel(a.getEventPixel(e.originalEvent),(i,s)=>i.getGeometry().getType()==="Point");a.getTargetElement().style.cursor=t?"pointer":""},y);const h=document.getElementById("tb_exit");window.addEventListener("load",function(e){const t=document.createElement("img");t.setAttribute("src","lime/lime.cgi?routemap"),t.setAttribute("width",1),t.setAttribute("height",1),h.parentNode.insertBefore(t,h)},y);
