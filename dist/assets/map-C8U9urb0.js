import{l as z,V as P,f as _,T as g,X as f,I as b,F as x,S as v,a as M,b as N,G as j,P as F,M as G,d as O,c as Z,t as V,e as A,g as R}from"./index-BYzSYGK_.js";import{C as D,T as X,f as E}from"./toolbar-o_ukZz47.js";import{S as Y}from"./searchbar-BHFz5KXB.js";z.install("G-VGB0R7REN2");const C="./share/",h=[[36.4967,139.3318,12,0,"全山行記録"],[36.5439,138.9261,9,14,"日本の主な山岳"],[36.5439,138.9261,9,1,"日本三百名山"],[36.5493,138.9261,10,2,"ぐんま百名山"],[36.5493,138.9261,10,11,"群馬300山"],[36.7332,139.7925,10,3,"栃木百名山"],[36.011,139.0491,11,8,"埼玉百山"],[35.7532,139.3463,11,15,"東京百名山"],[35.4036,139.3492,11,13,"かながわ百名山"],[36.1019,138.0629,9,5,"信州百名山"],[35.5747,138.6364,10,6,"山梨百名山"],[37.4422,140.1566,9,7,"うつくしま百名山"],[37.4422,140.1566,9,12,"新うつくしま百名山"],[37.6869,138.8786,9,10,"越後百山"],[36.4967,139.3318,12,4,"桐生地域百山"],[36.369,139.449,12,9,"足利百名山"]],n={idx:1,lat:void 0,lon:void 0,zoom:void 0,cat:void 0};for(const e of location.search.slice(1).split("&")){const t=e.split("=");t[0]in n&&(n[t[0]]=Number(t[1]))}(n.idx<0||n.idx>=h.length)&&(n.idx=1);const H=localStorage.getItem("idx");if(n.idx==H)for(const e in n)n[e]=localStorage.getItem(e);else{const e=h[n.idx];n.lat=e[0],n.lon=e[1],n.zoom=e[2],n.cat=e[3]}window.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("tb_category");for(const t of h)e.appendChild(new Option(t[4]));e.selectedIndex=n.idx,e.addEventListener("change",t=>{location.replace("map.html?idx="+e.selectedIndex)})});function I(e){return e>=11?0:e<=6?6:12-e}let L=I(n.zoom)<<3;const m=new P({center:_([Number(n.lon),Number(n.lat)]),maxZoom:18,minZoom:5,constrainResolution:!0,zoom:n.zoom}),y=['<a href="https://maps.gsi.go.jp/development/ichiran.html">地理院タイル</a>'],J=new g({source:new f({attributions:y,url:"https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png"}),title:"標準",type:"base"}),q=new g({source:new f({attributions:y,url:"https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png"}),title:"淡色",type:"base",visible:!1}),K=new g({source:new f({attributions:y,url:"https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg"}),title:"写真",type:"base",visible:!1}),Q=new g({source:new f({attributions:['&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors, ','&copy; <a href="https://opentopomap.org/">OpenTopoMap</a> ','(<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'],url:"https://tile.opentopomap.org/{z}/{x}/{y}.png"}),title:"OTM",type:"base",visible:!1}),U=[[new b({src:"./icon/902030.png",declutterMode:"none"}),new x({color:"blue"}),new v({color:"white",width:2})],[new b({src:"./icon/902031.png",declutterMode:"none"}),new x({color:"yellow"}),new v({color:"gray",width:2})]],W="14px sans-serif",$="left",ee=12,te=3;function ne(e){const t=e.get("p");if(t<L)return null;const o=e.get("c")>0?0:1,[s,a,d]=U[o],p=new A({text:e.get("name"),font:W,fill:a,stroke:d,textAlign:$,offsetX:ee,offsetY:te});return new R({image:s,text:p,zIndex:t&-8})}const w=new M({source:new N({url:C+"db.php?cat="+n.cat+"&v="+(n.cat>0?2:1),format:new j}),title:"山名",style:ne,declutter:!0}),B=new D({element:document.getElementById("centercross")}),r=new X({element:document.getElementById("toolbar")}),oe=new Y({element:document.getElementById("searchbar")}),S=new F({autoPan:!1}),i=new G({target:"map",layers:[J,q,K,Q,w],view:m,controls:O().extend([new Z,B,r,oe]),overlays:[S]}),se=document.getElementById("menu2");r.setToggleButton("tb_menu2",se);r.setPopup(S);r.setCenterButton("tb_center");r.setBaseSelect("tb_base");r.setZoomSelect("tb_zoom",e=>{m.setZoom(e),L=I(e)<<3,w.getSource().changed()});r.setCreditButton("tb_help","map/help.html");r.setLayerCheckbox("tb_sanmei",w);r.setControlCheckbox("tb_cross",B);function re(e,t){const o=e.split("-"),s=t.split("-");return s[0]!=o[0]?e+"/"+t:s[1]!=o[1]?e+"/"+s[1]+"-"+s[2]:s[2]!=o[2]?e+"/"+s[2]:e}const T=document.getElementById("result");r.setToggleButton("tb_result",T);const c=document.getElementById("items");function ae(e){for(;c.firstChild;)c.removeChild(c.firstChild);if(T.style.display="block",e.length==0){const t=document.createElement("tr");t.innerHTML="<td>なし</td>",c.appendChild(t);return}for(const t of e){const o=document.createElement("tr");o.innerHTML='<td><a href="'+t.link+'"><img src="'+(t.image||"image/no_image.png")+'" width="60" height="45"></a></td><td>'+re(t.start,t.end)+'<br><a href="'+t.link+'">'+t.title+"</a>："+t.summary+"</td>",c.appendChild(o)}}function ie(e,t,o){fetch(C+"db.php?rec="+e+"&c="+n.cat).then(s=>s.json()).then(function(s){const a=s.geo[0],d=Number(a.lon),p=Number(a.lat);a.x=E(d),a.y=E(p);const k=_([d,p]);a.gcpname=null,r.openPopupName(k,a),ae(s.rec)})}i.on("click",function(e){i.forEachFeatureAtPixel(e.pixel,function(t,o){return t.getGeometry().getType()!=="Point"?!1:(ie(t.getId()),!0)})});const l={passive:!0};i.on("pointermove",function(e){if(e.dragging)return;const t=i.forEachFeatureAtPixel(i.getEventPixel(e.originalEvent),(o,s)=>o.getGeometry().getType()==="Point");i.getTargetElement().style.cursor=t?"pointer":""},l);const u=document.getElementById("tb_exit");window.addEventListener("DOMContentLoaded",function(e){let t,o;window.opener?(t="✖︎",o=()=>window.close()):history.length>1?(t="戻る",o=()=>history.back()):(t="TOP",o=()=>location.assign(".")),u.innerText=t,u.addEventListener("click",o,l)},l);window.addEventListener("load",function(e){const t=new Image;t.src="lime/lime.cgi?map",t.width=1,t.height=1,u.parentNode.insertBefore(t,u)},l);window.addEventListener("beforeunload",function(e){const t=V(m.getCenter());n.lon=t[0].toFixed(6),n.lat=t[1].toFixed(6),n.zoom=m.getZoom();for(const o in n)localStorage.setItem(o,n[o])},l);
