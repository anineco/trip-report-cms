import{C as u,t as b}from"./index-BYzSYGK_.js";class E extends u{constructor(t={}){const e=t.element;super({element:e});const n=new Image(24,24);n.src="data:image/gif;base64,R0lGODlhGAAYAPAAAICAgAAAACH5BAEAAAEAIf8LSW1hZ2VNYWdpY2sOZ2FtbWE9MC40NTQ1NDUALAAAAAAYABgAAAIxjI+puwAMk4s0zAovbm9z/4FSJ5Ym4qSpcakq67ZdrJ02WJe5uOOk2fMEN0NM8XYoAAA7",e.appendChild(n),this.container=e,this.container.className=t.className||"ol-centercross ol-unselectable"}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}}function g(s){const t=parseInt(s*3600+.5);return[parseInt(t/3600),parseInt(t%3600/60),t%60]}function m(s){return(Number(s[2])/60+Number(s[1]))/60+Number(s[0])}function A(s){return String(s).match(/^(\d+)(\d\d)(\d\d)$/).slice(1)}function p(s){return m(A(s))}function y(s){const t=("0"+s[1]).slice(-2),e=("0"+s[2]).slice(-2);return s[0]+"°"+t+"′"+e+"″"}function h(s){return y(g(s))}function I(s){let t=s.match(/^(\d+)[,\s]\s*(\d+)$/);return t?[p(t[2]),p(t[1])]:(t=s.match(/^(\d+\.\d*)[,\s]\s*(\d+\.\d*)$/),t?[Number(t[2]),Number(t[1])]:(t=s.match(/(?:北緯)?\s*(\d+)°\s*(\d+)′\s*(\d+(\.\d*)?)″[,\n]?\s*(?:東経)?\s*(\d+)°\s*(\d+)′\s*(\d+(\.\d*)?)″/)||s.match(/(?:北緯)?\s*(\d+)度\s*(\d+)分\s*(\d+(\.\d*)?)秒[,\n]?\s*(?:東経)?\s*(\d+)度\s*(\d+)分\s*(\d+(\.\d*)?)秒/),t?[m(t.slice(5,8)),m(t.slice(1,4))]:null))}const f="./share/",l={passive:!0};class x extends u{constructor(t={}){const e=t.element;super({element:e}),this.container=e,this.container.className="ol-toolbar ol-unselectable"}setMap(t){super.setMap(t),this.map=t}setPopup(t){this.popup=t}openPopup(t){const e=b(t),n=e[0].toFixed(6),r=e[1].toFixed(6),d={x:h(e[0]),y:h(e[1])},c=[];c.push(new Promise(o=>fetch("https://cyberjapandata2.gsi.go.jp/general/dem/scripts/getelevation.php?outtype=JSON&lon="+n+"&lat="+r).then(a=>a.json()).then(a=>{d.alt=typeof a.elevation=="number"?Math.round(a.elevation+.5):-9999,o()}))),c.push(new Promise(o=>fetch(f+"db.php?rgc=1&lon="+n+"&lat="+r).then(a=>a.json()).then(a=>{d.address=a.length>0?a.map(i=>i.name):["-----"],o()}))),Promise.all(c).then(()=>{this.popup.show(t,"<h2>現在地</h2><table><tbody><tr><td>標高</td><td>"+d.alt+"m<tr><td>緯度</td><td>"+d.y+"</td></tr><tr><td>経度</td><td>"+d.x+"</td></tr><tr><td>所在</td><td>"+d.address.join("<br>")+"</td></tr></tbody></table>")})}openPopupName(t,e){this.popup.show(t,"<h2>"+e.name+"</h2><table><tbody><tr><td>よみ</td><td>"+e.kana+(e.alias.length>0?"</td></tr><tr><td>別名</td><td>"+e.alias.map(n=>"<ruby>"+n.name+"<rt>"+n.kana+"</rt></ruby>").join("<br>"):"")+"</td></tr><tr><td>標高</td><td>"+e.alt+"m"+(e.gcpname?"</td></tr><tr><td>点名</td><td>"+e.gcpname:"")+"</td></tr><tr><td>緯度</td><td>"+e.y+"</td></tr><tr><td>経度</td><td>"+e.x+(e.address.length>0?"</td></tr><tr><td>所在</td><td>"+e.address.join("<br>"):"")+"</td></tr><tr><td>ID</td><td>"+e.id+"</td></tr></tbody></table>")}closePopup(){this.popup.hide()}setToggleButton(t,e){document.getElementById(t).addEventListener("click",r=>{e.style.display=e.style.display=="none"?"block":"none"},l)}setCenterButton(t){document.getElementById(t).addEventListener("click",n=>{this.openPopup(this.map.getView().getCenter())},l)}setBaseSelect(t){const e=document.getElementById(t),n=this.map.getLayers().getArray().filter(d=>d.get("type")=="base");let r=0;n.forEach((d,c)=>{const o=d.getVisible();o&&(r=c),e.appendChild(new Option(d.get("title"),o,o))}),e.selectedIndex=r,e.addEventListener("change",d=>{n.forEach((c,o)=>c.setVisible(o==e.selectedIndex))},l)}setZoomSelect(t,e){const n=document.getElementById(t),r=this.map.getView(),d=r.getMaxZoom(),c=r.getMinZoom();for(let o=d;o>=c;o--)n.appendChild(new Option(o));n.selectedIndex=d-r.getZoom(),n.addEventListener("change",o=>{const a=n.options[n.selectedIndex].value;e(a)},l),this.map.on("moveend",o=>{const a=r.getZoom(),i=d-a;n.selectedIndex!=i&&(n.selectedIndex=i,n.dispatchEvent(new Event("change")))},l)}setCreditButton(t,e){document.getElementById(t).addEventListener("click",r=>{window.open(e)},l)}setLayerCheckbox(t,e){const n=document.getElementById(t);n.addEventListener("change",r=>{e.setVisible(n.checked)},l)}setControlCheckbox(t,e){const n=document.getElementById(t);n.addEventListener("change",r=>{n.checked?e.show():e.hide()},l)}}export{E as C,x as T,I as a,h as f};
